\documentclass{article}
\usepackage{amsthm, amssymb,amsmath}
\usepackage{graphicx} % Required for inserting images
\setlength\parindent{0pt} % No indentation for file

\title{MATH425 - Homework 1}
\author{Bryan Lee}
\date{September 9, 2024}

\begin{document}

\maketitle

\section*{Exercise 2}
In this exercise, we will use the following matrix to illustrate how to compute the LU decomposition
and how to use it:
$$ A = \left( \begin{array}{rrrr} -8 & -2 & 3 & 1 \\ 1 & -2 & 0 & 2 \\ -4 & -1 &
3 & 2 \\ 4 & 1 & -1 & -1 \end{array} \right)$$
By Gaussian elimination, one can reduce the above $A$ to an upper triangular matrix
by using row operations of the type $cR_i + R_j \rightarrow R_j$. \\
{\bf a)} State the first-row operation you would do in order to reduce $A$ to an
upper triangular matrix and apply this row operation to
obtain the matrix $A_1$.\\

\[
A = 
\left(
\begin{array}{rrrr}
-8 & -2 & 3 & 1 \\
1 & -2 & 0 & 2 \\
-4 & -1 & 3 & 2 \\
4 & 1 & -1 & -1 
\end{array}
\right)
\hspace{0.1cm}
\begin{aligned}
& \frac{1}{8}R_1 + R_2 \rightarrow R_2 \quad\Longrightarrow
\end{aligned}
A_1 =
\left(
\begin{array}{rrrr}
-8 & -2 & 3 & 1 \\
0 & -\frac{9}{4} & \frac{3}{8} & \frac{17}{8} \\
-4 & -1 & 3 & 2 \\
4 & 1 & -1 & -1 
\end{array}
\right)
\]\\

{\bf b)} Find the corresponding elementary matrix $E_1$. Then compute $E_1A$. What
do you observe? \\

\[
E_1 = 
\left(
\begin{array}{rrrr}
1 & 0 & 0 & 0 \\
\frac{1}{8} & 1 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1 
\end{array}
\right)
\hspace{0.5cm} \& \hspace{0.5cm}
E_1A =
\left(
\begin{array}{rrrr}
-8 & -2 & 3 & 1 \\
0 & -\frac{9}{4} & \frac{3}{8} & \frac{17}{8} \\
-4 & -1 & 3 & 2 \\
4 & 1 & -1 & -1 
\end{array}
\right)
\]\\
I observe that the matrix multiplication of $E_1A$ yields the $A_1$ matrix. It also turns the $a_{2,1}$ element into 0, the start of the triangle of 0s.\\\\

{\bf c)} State and apply the next row operation that needs to be applied to $A_1$
to obtain $A_2$. \\

\[
A_1 =
\left(
\begin{array}{rrrr}
-8 & -2 & 3 & 1 \\
0 & -\frac{9}{4} & \frac{3}{8} & \frac{17}{8} \\
-4 & -1 & 3 & 2 \\
4 & 1 & -1 & -1 
\end{array}
\right)
\hspace{0.1cm}
\begin{aligned}
& -\frac{1}{2}R_1 + R_3 \rightarrow R_3 \quad\Longrightarrow
\end{aligned}
A_2 =
\left(
\begin{array}{rrrr}
-8 & -2 & 3 & 1 \\
0 & -\frac{9}{4} & \frac{3}{8} & \frac{17}{8} \\
0 & 0 & \frac{3}{2} & \frac{3}{2} \\
4 & 1 & -1 & -1 
\end{array}
\right)
\]\\\\

{\bf d)} Construct the corresponding elementary matrix $E_2$. Compute $E_2 A_1$. \\

\[
E_2 = 
\left(
\begin{array}{rrrr}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
-\frac{1}{2} & 0 & 1 & 0 \\
0 & 0 & 0 & 1 
\end{array}
\right)
\hspace{0.5cm} \& \hspace{0.5cm}
E_2A_1 =
\left(
\begin{array}{rrrr}
-8 & -2 & 3 & 1 \\
0 & -\frac{9}{4} & \frac{3}{8} & \frac{17}{8} \\
0 & 0 & \frac{3}{2} & \frac{3}{2} \\
4 & 1 & -1 & -1 
\end{array}
\right)
\]\\\\

{\bf e)} Now continue to construct $E_3$ and $ E_4$. Verify $E_4E_3E_2E_1A = U$
where $U$ is an upper triangular matrix. \\

\[
A_2 =
\left(
\begin{array}{rrrr}
-8 & -2 & 3 & 1 \\
0 & -\frac{9}{4} & \frac{3}{8} & \frac{17}{8} \\
0 & 0 & \frac{3}{2} & \frac{3}{2} \\
4 & 1 & -1 & -1 
\end{array}
\right)
\hspace{0.1cm}
\begin{aligned}
& \frac{1}{2}R_1 + R_4 \rightarrow R_4 \quad\Longrightarrow
\end{aligned}
A_3 =
\left(
\begin{array}{rrrr}
-8 & -2 & 3 & 1 \\
0 & -\frac{9}{4} & \frac{3}{8} & \frac{17}{8} \\
0 & 0 & \frac{3}{2} & \frac{3}{2} \\
0 & 0 & \frac{1}{2} & -\frac{1}{2}
\end{array}
\right)
\hspace{0.1cm}
\begin{aligned}
& -\frac{1}{3}R_3 + R_4 \rightarrow R_4
\end{aligned}
\]\\

\[
\begin{aligned}
\Longrightarrow \quad
A_4 = E_4E_3E_2E_1A = U =
\left(
\begin{array}{rrrr}
-8 & -2 & 3 & 1 \\
0 & -\frac{9}{4} & \frac{3}{8} & \frac{17}{8} \\
0 & 0 & \frac{3}{2} & \frac{3}{2} \\
0 & 0 & 0 & -1
\end{array}
\right)
\end{aligned}
\]

Thus,

\[
E_3 = 
\left(
\begin{array}{rrrr}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 \\
\frac{1}{2} & 0 & 0 & 1 
\end{array}
\right)
\hspace{0.5cm} \& \hspace{0.5cm}
E_4 = 
\left(
\begin{array}{rrrr}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & -\frac{1}{3} & 1 
\end{array}
\right)
\]\\\\

{\bf f)} Compute the inverses of $E_1, \ldots, E_4$. State the pattern you see. \\

\[
E_1^{-1} = 
\left(
\begin{array}{rrrr|rrrr}
1 & 0 & 0 & 0 & 1 & 0 & 0 & 0 \\
\frac{1}{8} & 1 & 0 & 0 & 0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1 & 0 & 0 & 0 & 1 
\end{array}
\right)
\hspace{0.1cm}
\begin{aligned}
& -\frac{1}{8}R_1 + R_2 \rightarrow R_2 \quad\Longrightarrow
\end{aligned}
\]\\

\[
\left(
\begin{array}{rrrr|rrrr}
1 & 0 & 0 & 0 & 1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 & -\frac{1}{8} & 1 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1 & 0 & 0 & 0 & 1 
\end{array}
\right)
\begin{aligned}
& \quad\Longrightarrow
\left(
\begin{array}{rrrr}
1 & 0 & 0 & 0 \\
-\frac{1}{8} & 1 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1 
\end{array}
\right)
\end{aligned}
\]\\

Repeated process for E2, E3, E4, thus:

\[
E_2^{-1} = 
\left(
\begin{array}{rrrr}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
\frac{1}{2} & 0 & 1 & 0 \\
0 & 0 & 0 & 1 
\end{array}
\right)
\hspace{0.5cm} \& \hspace{0.5cm}
E_3^{-1} = 
\left(
\begin{array}{rrrr}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 \\
-\frac{1}{2} & 0 & 0 & 1 
\end{array}
\right)
\hspace{0.5cm} \& \hspace{0.5cm}
E_4^{-1} = 
\left(
\begin{array}{rrrr}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & \frac{1}{3} & 1 
\end{array}
\right)
\]\\

Observation: The inverses swap the sign of the constant in the row operation $cR_i + R_j \rightarrow R_j$, where each row operation is represented by a $E_i$ matrix.\\\\

{\bf g)} Argue that $A = LU$ where $L= E_1^{-1}E_2^{-1} E_3^{-1}E_4^{-1}$. What
kind of matrix is $L$? \\
We have obtained
an LU factorization of $A$. To check your work, use \\
{\tt >> [L, U] = lu(A)} \\
command in MATLAB to get the LU factorization of $A$. \\

Since $E_1, ..., E_4$ are matrices that represent the respective row operations performed on the matrix $A$ to obtain the upper-triangular matrix $U$, taking the inverse of $E_1, ..., E_4$, representing $L$, will undo these operations, restoring the upper-triangular matrix to its original form of $A$. Additionally, $L$ is a product of inverses of elementary matrices, and elementary matrices themselves are invertible; thus, L is invertible and a lower-triangular matrix.\\\\

{\bf h)} In Matlab file.

\section*{Exercise 3}
Suppose in the linear system $Ax = b$ the matrix $A$ is an $n \
times n$ regular matrix. \\
{\bf a)} Count the number of multiplication/division operations
needed to find the solution $x$ by Gaussian elimination and backward substitution.
The answer should be a formula involving a polynomial in $n$.
What is the degree and the leading coefficient of this polynomial? \\

For Gaussian elimination, taking the summation of the for-loops and computing them:

\begin{align*}
T(n) &= \sum_{j=1}^{n} \sum_{i=j+1}^{n} \sum_{x=j}^{n+1} 1 \\
     &= \sum_{j=1}^{n} \sum_{i=j+1}^{n} ((n+1) + 1 - j) = \sum_{j=1}^{n} \sum_{i=j+1}^{n} (n + 2 - j) \\
     &= \sum_{j=1}^{n} (n+1-(j+1)(n+2-j) = \sum_{j=1}^{n} ((n-j)^2 + 2(n-j)) \\
     &= \sum_{j=1}^{n} (n-j)^2 + 2 \sum_{j=1}^{n} (n-j) \\
     \text{Let } k = (n-j), \text{ then} \\
     &= \sum_{k=0}^{n-1} k^2 + 2 \sum_{k=0}^{n-1} k \\
     &= \frac{(n-1)((n-1)+1)(2(n-1)+1)}{6} + 2(\frac{(n-1)((n-1)+1)}{2})\\
     &= \frac{(n-1)(n)(2n-1)}{6} + n^2 - n \\
     &= \frac{2n^3 + 3n^2 - 5n}{6}
\end{align*} \\

Now for Backward substitution:

\begin{align*}
T(n) &= \sum_{i=1}^{n} \sum_{j=i+1}^{n} 1 \\
     &= \sum_{i=1}^{n} (n+1-(i+1)) = \sum_{i=1}^{n} (n-i) \\
     &= \sum_{i=1}^{n} n - \sum_{i=1}^{n} i \\
     &= n^2 - \frac{n(n+1)}{2} \\
     &= \frac{n^2 - n}{2} \\
\end{align*} \\

Merging Gaussian elimination and backward substitution: \\
\begin{align*}
T(n) = \frac{2n^3 + 3n^2 - 5n}{6} + \frac{n^2 - n}{2} = \frac{n^3}{3} + n^2 - \frac{4n}{3}
\end{align*} \\

The degree of the polynomial is: 3\\
The coefficient of the polynomial is: $\frac{1}{3}$ \\\\

{\bf b)} Now count the number of multiplications/divisions to compute $A^{-1}$ and
to find $x$ by $x=A^{-1}b$. What is the degree and the leading
coefficient of the resulting polynomial in $n$ in your formula? \\

Compute number of multiplications/divisions to inverse A by taking the summation of the for-loops and computing them:

\begin{align*}
T(n) &= \sum_{i=1}^{n} ( \sum_{x=1}^{2n} 1 +  (\sum_{j=1}^{n-1} \sum_{x=1}^{2n} 1) ) \\
     &= \sum_{i=1}^{n} ( (2n+1-1) + (\sum_{j=1}^{n-1} (2n+1-1)) ) \\
     &= \sum_{i=1}^{n} ( 2n + (\sum_{j=1}^{n-1} 2n) ) \\
     &= \sum_{i=1}^{n} ( 2n + (2n(n-1+1-1)) = \sum_{i=1}^{n} ( 2n + (2n^2 - 2n)) \\
     &= \sum_{i=1}^{n} (2n^2) = n(2n^2) = 2n^3
\end{align*} \\

Now, to solve for x, it is simply multiplying A inverse with b, which is a double for-loop:

\begin{align*}
T(n) &= \sum_{n}^{i=1} \sum_{n}^{j=1} 1 = n^2\\
\end{align*} \\

Combining the two operations gives us:

\begin{align*}
T(n) &= \sum_{n}^{i=1} \sum_{n}^{j=1} 1 = n^2\\
\end{align*} \\

And merging the two together yields:
\begin{align*}
T(n) &= 2n^3 + n^2\\
\end{align*}

Where the degree of the polynomial is $3$ and the coefficient is $2$.\\\\

{\bf c)} Based on your answers above, which method will you use for large $n$?
Explain. \\

Since both methods have a polynomial degree of 3, I have to look at the coefficient. Gaussian elimination and backward substitution have a smaller coefficient of $\frac {1}{3}$ while finding the inverse of A has a coefficient of $2$. In conclusion, the Gaussian elimination and backward substitution would be a more viable method for large $n$, as it will be about six times faster than finding the inverse of A.

\end{document}
